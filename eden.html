<!DOCTYPE html>
<html>
<head>
    <title>Random Movement Animation</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
<canvas id="movementCanvas" width="600" height="600"></canvas>

<script>
    const canvas = document.getElementById('movementCanvas');
    const ctx = canvas.getContext('2d');
    const n = 100;
    const length = n;
    const size = 2 * n + 1;
    const rangeMin = -n;
    let positions = new Map(); // To store and update positions

    function movePoint(point, maxLength) {
        const [x, y] = point.split(',').map(Number);
        const moves = ['+e1', '-e1', '+e2', '-e2'];
        const move = moves[Math.floor(Math.random() * moves.length)];

        let newX = x, newY = y;
        switch(move) {
            case '+e1': newX += 1; break;
            case '-e1': newX -= 1; break;
            case '+e2': newY += 1; break;
            case '-e2': newY -= 1; break;
        }

        newX = Math.max(-maxLength, Math.min(maxLength, newX));
        newY = Math.max(-maxLength, Math.min(maxLength, newY));

        return `${newX},${newY}`;
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas
        positions.forEach((_, key) => {
            const [x, y] = key.split(',').map(Number);
            const canvasX = (x + n) * (canvas.width / size);
            const canvasY = (y + n) * (canvas.height / size);
            ctx.fillRect(canvasX, canvasY, 5, 5); // Draw each point
        });
    }

    function update() {
        const newPositions = new Map();
        positions.forEach((_, key) => {
            const newKey = movePoint(key, length);
            newPositions.set(newKey, true);
        });
        positions = newPositions;
        draw();
        requestAnimationFrame(update); // Continue animation
    }

    // Initialize positions
    positions.set(`${0},${0}`, true); // Starting point

    draw();
    requestAnimationFrame(update); // Start animation
</script>
</body>
</html>
